=pod

=head1 NAME

PEM_FLAG_SECURE, PEM_FLAG_WEAK_EOL,
PEM_read_bio_flags - read PEM format files with custom processing

=head1 SYNOPSIS

 #include <openssl/pem.h>

 #define PEM_FLAG_SECURE       0x1
 #define PEM_FLAG_WEAK_EOL     0x2
 int PEM_read_bio_flags(BIO *in, char **name, char **header,
                        unsigned char **data, long *len, unsigned int flags);

=head1 DESCRIPTION

PEM_read_bio_flags() reads in PEM formatted data from an input BIO, outputting
the name of the type of contained data, the header information regarding
the possibly encrypted data, and the binary data payload (after base64 decoding).
It should generally only be used to implement PEM_read_bio_-family functions
for specific data types or other usage, but is exposed to allow greater flexibility
over how processing is performed, if needed.

If PEM_FLAG_SECURE is set, the intermediate buffers used to read in lines of
input are allocated from the secure heap.

If PEM_FLAG_WEAK_EOL is set, a simple algorithm is used to remove whitespace
and control characters from the end of each line, so as to be compatible with
the historical behavior of PEM_read_bio().  Otherwise, the entire line is
checked for control characters, and trailing whitespace is unmodified by the
line-reading routine, since it is ignored by the base64 decoding process.

=head1 NOTES

The caller must release the storage allocated for *name, *header, and *data.
If PEM_FLAG_SECURE was set, use OPENSSL_secure_free(); otherwise,
OPENSSL_free() is used.

=head1 RETURN VALUES

PEM_read_bio_flags() returns 1 for success or 0 for failure.

=head1 SEE ALSO

L<PEM(3)>

=head1 HISTORY

PEM_read_bio_flags() was added to Akamai's openssl-6.102.7.0.

=head1 COPYRIGHT

Copyright 2000-2016 The OpenSSL Project Authors. All Rights Reserved.

Licensed under the OpenSSL license (the "License").  You may not use
this file except in compliance with the License.  You can obtain a copy
in the file LICENSE in the source distribution or at
L<https://www.openssl.org/source/license.html>.

Copyright (C) 2016 Akamai Technologies. ALL RIGHTS RESERVED.

This code was originally developed by Akamai Technologies and
contributed to the OpenSSL project under the terms of the Corporate
Contributor License Agreement v1.0

=cut
